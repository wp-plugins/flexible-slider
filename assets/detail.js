jQuery(document).ready(function(e){jQuery("#sortable").sortable();jQuery("#sortable").disableSelection();jQuery("#drag-radio").buttonset();jQuery("#auto-radio").buttonset();jQuery("#infinite-radio").buttonset();jQuery("#keyboard-radio").buttonset();jQuery.farbtastic("#titlecolorpicker",function(){jQuery("#titlecolor").val(this.color.toUpperCase())});jQuery.farbtastic("#desccolorpicker",function(){jQuery("#desccolor").val(this.color.toUpperCase())});jQuery("li.ui-state-default > a.fslider-image-delete").live("click",function(m){m.preventDefault();var l=jQuery(this);var t=jQuery(this).attr("href");t=t.replace("#","");var w=jQuery("#images").val();w=w.split("|");var s=true;var v="";for(var q=0;q<w.length;q++){if(!(w[q]==t)){if(s){v=w[q];s=false}else{v+="|"+w[q]}}else{var p=q}}var n=h("slidetitles",p);var k=h("links",p);var o=h("targets",p);var r=h("descriptions",p);var u=jQuery("#itemid").val();jQuery.ajax({url:"?page=flexibleslider_delete_image&itemid="+u+"&removedImage="+t+"&remainedImages="+v,data:"remainedSlideTitles="+n+"&remainedLinks="+k+"&remainedLinkTargets="+o+"&remainedDescriptions="+r,type:"POST",beforeSend:function(){jQuery("#ajax-load").css("display","block")},success:function(){jQuery("#images").val(v);jQuery("#slidetitles").val(n);jQuery("#links").val(k);jQuery("#targets").val(o);jQuery("#descriptions").val(r);l.parent().remove();jQuery("#ajax-load").css("display","none")},error:function(){}})});jQuery("#sortable").bind("sortupdate",function(o,q){var k=jQuery("li.ui-state-default > a.fslider-image-delete").toArray();var r=true;for(var m=0;m<k.length;m++){var p=k[m].toString();var n=p.split("#");n=n[1];if(r){jQuery("#images").val("");jQuery("#images").val(n);r=false}else{var l=jQuery("#images").val()+"|"+n;jQuery("#images").val(l)}}g(jQuery("li.ui-state-default > .slide-title").toArray(),"slidetitles");g(jQuery("li.ui-state-default > .link").toArray(),"links");g(jQuery("li.ui-state-default > .link-target").toArray(),"targets");g(jQuery("li.ui-state-default > .description").toArray(),"descriptions")});jQuery('[name="saveclose"]').click(function(){jQuery("#close").val("1")});var a;jQuery("li.ui-state-default > a.fslider-image-edit").live("click",function(k){k.preventDefault();a=jQuery(this);jQuery("#slide-title").val(d(a.nextAll(".slide-title").val()));jQuery("#link").val(a.nextAll(".link").val());jQuery("#link-target").val(a.nextAll(".link-target").val());jQuery("#description").val(d(a.nextAll(".description").val()));jQuery("#dialog-form").dialog("open")});jQuery("#dialog-form").dialog({autoOpen:false,resizable:false,draggable:true,height:450,width:350,modal:true,buttons:{OK:function(){a.nextAll(".slide-title").val(j(jQuery("#slide-title").val()));a.nextAll(".link").val(jQuery("#link").val());a.nextAll(".link-target").val(jQuery("#link-target").val());a.nextAll(".description").val(j(jQuery("#description").val()));g(jQuery("li.ui-state-default > .slide-title").toArray(),"slidetitles");g(jQuery("li.ui-state-default > .link").toArray(),"links");g(jQuery("li.ui-state-default > .link-target").toArray(),"targets");g(jQuery("li.ui-state-default > .description").toArray(),"descriptions");jQuery(this).dialog("close")},Cancel:function(){jQuery(this).dialog("close")}},close:function(){}});function g(n,l){var o=true;for(var k=0;k<n.length;k++){var m=n[k].value;if(o){jQuery("#"+l).val("");jQuery("#"+l).val(m);o=false}else{jQuery("#"+l).val(jQuery("#"+l).val()+"|"+m)}}}function h(l,m){var p=jQuery("#"+l).val();p=p.split("|");var o=true;var n="";for(var k=0;k<p.length;k++){if(!(k==m)){if(o){n=p[k];o=false}else{n+="|"+p[k]}}}return n}var b=navigator.userAgent.toLowerCase();if(b.indexOf(" chrome/")>=0||b.indexOf(" firefox/")>=0||b.indexOf(" gecko/")>=0){var i=function(){this.str="";this.length=0;this.append=function(k){this.str+=k;this.length+=k.length};this.prepend=function(k){this.str=k+this.str;this.length+=k.length};this.toString=function(){return this.str}}}else{var i=function(){this.parts=[];this.length=0;this.append=function(k){this.parts.push(k);this.length+=k.length};this.prepend=function(k){this.parts.unshift(k);this.length+=k.length};this.toString=function(){return this.parts.join("")}}}var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function j(m){var k=new i();var t,r,p;var s,q,o,n;var l=0;while(l<m.length){t=m.charCodeAt(l++);r=m.charCodeAt(l++);p=m.charCodeAt(l++);s=t>>2;q=((t&3)<<4)|(r>>4);o=((r&15)<<2)|(p>>6);n=p&63;if(isNaN(r)){o=n=64}else{if(isNaN(p)){n=64}}k.append(c.charAt(s)+c.charAt(q)+c.charAt(o)+c.charAt(n))}return k.toString()}function d(m){var k=new i();var t,r,p;var s,q,o,n;var l=0;m=m.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(l<m.length){s=c.indexOf(m.charAt(l++));q=c.indexOf(m.charAt(l++));o=c.indexOf(m.charAt(l++));n=c.indexOf(m.charAt(l++));t=(s<<2)|(q>>4);r=((q&15)<<4)|(o>>2);p=((o&3)<<6)|n;k.append(String.fromCharCode(t));if(o!=64){k.append(String.fromCharCode(r))}if(n!=64){k.append(String.fromCharCode(p))}}return k.toString()}function e(k){return document.getElementById(k)}var f=new plupload.Uploader({runtimes:"html5, flash",browse_button:"pickfiles",max_file_size:"8mb",url:"",flash_swf_url:jQuery("#url").val()+"/assets/plupload.flash.swf",filters:[{title:"Image files",extensions:"jpg,gif,png"}]});f.bind("Init",function(k,l){e("runtime").innerHTML=l.runtime.toUpperCase()});f.bind("FilesAdded",function(k,m){for(var l=0;l<m.length;l++){e("filelist").innerHTML+='<div id="'+m[l].id+'"><br />- '+m[l].name+" ("+plupload.formatSize(m[l].size)+") <b></b></div>"}});f.bind("BeforeUpload",function(k,m){var o=e("itemid").value;var l=m.id;var n=m.name.split(".").pop().toLowerCase();k.settings.url="?page=flexibleslider_upload&itemid="+o+"&uniquename="+l+"."+n});f.bind("UploadProgress",function(k,l){e(l.id).getElementsByTagName("b")[0].innerHTML="<span>"+l.percent+"%</span> <span class='ajax-load'></span>";e(l.id).style.color="green"});f.bind("FileUploaded",function(k,n){var o=n.name.split(".").pop().toLowerCase();var m=n.id;if(e("images").value==""){e("images").value=m+"."+o}else{e("images").value+="|"+m+"."+o;e("slidetitles").value+="|";e("links").value+="|";e("targets").value+="|";e("descriptions").value+="|"}jQuery("#"+m).fadeOut("slow").hide();var l=jQuery("#url").val();var p=jQuery("#itemid").val();jQuery("#sortable").append('<li class="ui-state-default"><img src="'+l+"/images/"+p+"/thumb/"+m+"."+o+'" /><a href="#'+m+"."+o+'" class="fslider-image-delete">Delete</a><a href="#'+m+"."+o+'" class="fslider-image-edit">Edit</a><input type="hidden" class="slide-title" value="" /><input type="hidden" class="link" value="" /><input type="hidden" class="link-target" value="" /><input type="hidden" class="description" value="" /></li>')});e("uploadfiles").onclick=function(){f.start();return false};f.init()});